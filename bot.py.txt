import asyncio
import logging
import json
import os
import sys
from datetime import datetime
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram.utils.keyboard import InlineKeyboardBuilder
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.context import FSMContext
from aiogram.fsm.storage.memory import MemoryStorage

# ==================== –ù–ê–°–¢–†–û–ô–ö–ê ====================
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
BOT_TOKEN = "8156674134:AAH2t8wCtxo95-_t3HQUFaOMBBHVPMWdQaU"  # –í–∞—à —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
ADMIN_ID = 951154134  # ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–¥—Ä—É–≥–∞)

# –ö–æ–Ω—Ç–∞–∫—Ç—ã
SUPPORT_USERNAME = "@svetonaya"
AUTHOR_USERNAME = "@svetonaya"  # –ê–≤—Ç–æ—Ä –¥–ª—è –≤—ã–¥–∞—á–∏ –Ω–æ–º–µ—Ä–æ–≤
CHANNEL_LINK = "https://t.me/shopsfiznumber"
CREATOR_LINK = "@UGLYLELOOSH"

# –†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–∞—Ä—Ç—ã (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ò!)
CARD_NUMBER = "2200 1234 5678 9012"  # –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã
CARD_HOLDER = "–ò–í–ê–ù –ò–í–ê–ù–û–í"           # –ò–º—è –¥–µ—Ä–∂–∞—Ç–µ–ª—è

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    logger.error("‚ùå –û–®–ò–ë–ö–ê: BOT_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω!")
    sys.exit(1)

# ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
bot = Bot(token=BOT_TOKEN)
storage = MemoryStorage()
dp = Dispatcher(storage=storage)

# –§–∞–π–ª—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
DATA_FILE = "numbers.json"

# ==================== –°–û–°–¢–û–Ø–ù–ò–Ø FSM ====================
class AdminStates(StatesGroup):
    adding_country = State()
    adding_number = State()
    adding_multiple_numbers = State()
    editing_price = State()

# ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –î–ê–ù–ù–´–ú–ò ====================
def load_numbers():
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–æ–º–µ—Ä–∞ –∏–∑ —Ñ–∞–π–ª–∞"""
    if os.path.exists(DATA_FILE):
        try:
            with open(DATA_FILE, 'r', encoding='utf-8') as f:
                return json.load(f)
        except:
            return {}
    return {}

def save_numbers(data):
    """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–º–µ—Ä–∞ –≤ —Ñ–∞–π–ª"""
    with open(DATA_FILE, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=4)

def init_data():
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–ü–£–°–¢–£–Æ!)"""
    data = load_numbers()
    if not data:
        # –ü–£–°–¢–´–ï –ú–ê–°–°–ò–í–´ - –Ω–∏–∫–∞–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤!
        initial_data = {
            "–ë–∞–Ω–≥–ª–∞–¥–µ—à": {
                "price": 120,
                "numbers": []
            },
            "–í—å–µ—Ç–Ω–∞–º": {
                "price": 115,
                "numbers": []
            },
            "–ò–Ω–¥–∏—è": {
                "price": 100,
                "numbers": []
            },
            "–ú—å—è–Ω–º–∞": {
                "price": 130,
                "numbers": []
            }
        }
        save_numbers(initial_data)
        logger.info("‚úÖ –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø—É—Å—Ç–∞—è)")
        return initial_data
    return data

# ==================== –ö–û–ú–ê–ù–î–´ –ë–û–¢–ê ====================
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    """–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    keyboard = InlineKeyboardBuilder()
    
    keyboard.add(InlineKeyboardButton(text="üì± –ö—É–ø–∏—Ç—å –Ω–æ–º–µ—Ä", callback_data="buy_number"))
    keyboard.add(InlineKeyboardButton(text="‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", callback_data="info"))
    keyboard.add(InlineKeyboardButton(text="ü§ù –ê–ª—å—è–Ω—Å", callback_data="alliance"))
    keyboard.add(InlineKeyboardButton(text="üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞", url=f"https://t.me/{SUPPORT_USERNAME[1:]}"))
    
    # –ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    if message.from_user.id == ADMIN_ID:
        keyboard.add(InlineKeyboardButton(text="‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å", callback_data="admin_panel"))
    
    keyboard.adjust(1)
    
    await message.answer(
        "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–µ —Ñ–∏–∑ –Ω–æ–º–µ—Ä–æ–≤!\n\n"
        "üõí –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        reply_markup=keyboard.as_markup()
    )

# –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
@dp.callback_query(lambda c: c.data == "buy_number")
async def show_countries(callback: types.CallbackQuery):
    data = load_numbers()
    
    if not data:
        await callback.message.answer("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤.")
        return
    
    keyboard = InlineKeyboardBuilder()
    
    for country, info in data.items():
        available_count = sum(1 for num in info["numbers"] if not num.get("used", False))
        if available_count > 0:
            keyboard.add(InlineKeyboardButton(
                text=f"üìç {country} ({available_count} —à—Ç.) - {info['price']}‚ÇΩ",
                callback_data=f"country_{country}"
            ))
    
    keyboard.add(InlineKeyboardButton(text="‚Ü©Ô∏è –ù–∞–∑–∞–¥", callback_data="back_to_main"))
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        "üåç –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –Ω–æ–º–µ—Ä–∞:\n"
        "(–≤ —Å–∫–æ–±–∫–∞—Ö —É–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤)",
        reply_markup=keyboard.as_markup()
    )

# –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã
@dp.callback_query(lambda c: c.data.startswith("country_"))
async def show_numbers_by_country(callback: types.CallbackQuery):
    country = callback.data.split("_")[1]
    data = load_numbers()
    
    if country not in data:
        await callback.answer("‚ùå –°—Ç—Ä–∞–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    country_info = data[country]
    available_numbers = [num for num in country_info["numbers"] if not num.get("used", False)]
    
    if not available_numbers:
        await callback.answer("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤")
        return
    
    keyboard = InlineKeyboardBuilder()
    
    for number in available_numbers:
        keyboard.add(InlineKeyboardButton(
            text=f"üìû {number['number']} - {number['price']}‚ÇΩ",
            callback_data=f"select_number_{country}_{number['id']}"
        ))
    
    keyboard.add(InlineKeyboardButton(text="‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å—Ç—Ä–∞–Ω–∞–º", callback_data="buy_number"))
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        f"üì± –î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ ({country}):\n\n"
        f"üí≥ –¶–µ–Ω–∞: {country_info['price']}‚ÇΩ –∑–∞ –Ω–æ–º–µ—Ä\n"
        f"üìä –î–æ—Å—Ç—É–ø–Ω–æ: {len(available_numbers)} —à—Ç.\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–ª—è –ø–æ–∫—É–ø–∫–∏:",
        reply_markup=keyboard.as_markup()
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–æ–º–µ—Ä–∞
@dp.callback_query(lambda c: c.data.startswith("select_number_"))
async def select_number(callback: types.CallbackQuery):
    parts = callback.data.split("_")
    country = parts[2]
    number_id = int(parts[3])
    
    data = load_numbers()
    
    # –ù–∞–π—Ç–∏ –Ω–æ–º–µ—Ä
    number_info = None
    for num in data[country]["numbers"]:
        if num["id"] == number_id and not num.get("used", False):
            number_info = num
            break
    
    if not number_info:
        await callback.answer("‚ùå –ù–æ–º–µ—Ä —É–∂–µ –ø—Ä–æ–¥–∞–Ω")
        return
    
    payment_text = (
        f"‚úÖ –í—ã –≤—ã–±—Ä–∞–ª–∏:\n\n"
        f"üåç –°—Ç—Ä–∞–Ω–∞: {country}\n"
        f"üìû –ù–æ–º–µ—Ä: {number_info['number']}\n"
        f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: {number_info['price']}‚ÇΩ\n\n"
        f"üí≥ –û–ø–ª–∞—Ç–∞ –ø–æ –∫–∞—Ä—Ç–µ:\n\n"
        f"1. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ {number_info['price']}‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É:\n"
        f"   üí≥ {CARD_NUMBER}\n"
        f"   üë§ {CARD_HOLDER}\n\n"
        f"2. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞:\n"
        f"   üì® {AUTHOR_USERNAME}\n\n"
        f"3. –ê–≤—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä–∏—Ç –ø–ª–∞—Ç–µ–∂ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç –Ω–æ–º–µ—Ä\n\n"
        f"‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:\n"
        f"   –ü–æ–∫—É–ø–∫–∞ {country} ‚Ññ{number_id}"
    )
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(
        text="üì® –ù–∞–ø–∏—Å–∞—Ç—å –∞–≤—Ç–æ—Ä—É —Å —á–µ–∫–æ–º", 
        url=f"https://t.me/{AUTHOR_USERNAME[1:]}"
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ –Ω–æ–º–µ—Ä–∞–º", 
        callback_data=f"country_{country}"
    ))
    keyboard.adjust(1)
    
    # –£–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∞ –æ –≤—ã–±–æ—Ä–µ –Ω–æ–º–µ—Ä–∞
    try:
        username = callback.from_user.username
        user_info = f"@{username}" if username else f"ID: {callback.from_user.id}"
        admin_msg = (
            f"üõí –ö–õ–ò–ï–ù–¢ –í–´–ë–†–ê–õ –ù–û–ú–ï–†!\n\n"
            f"üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: {user_info}\n"
            f"üåç –°—Ç—Ä–∞–Ω–∞: {country}\n"
            f"üìû –ù–æ–º–µ—Ä ID: {number_id}\n"
            f"üì± –ù–æ–º–µ—Ä: {number_info['number']}\n"
            f"üí∞ –¶–µ–Ω–∞: {number_info['price']}‚ÇΩ\n\n"
            f"‚ö†Ô∏è –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã –Ω–∞ –∫–∞—Ä—Ç—É!"
        )
        await bot.send_message(ADMIN_ID, admin_msg)
    except:
        pass
    
    await callback.message.edit_text(
        payment_text,
        reply_markup=keyboard.as_markup()
    )

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
@dp.callback_query(lambda c: c.data == "info")
async def show_info(callback: types.CallbackQuery):
    info_text = (
        "‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ:\n\n"
        "üì± –ß—Ç–æ –ø—Ä–æ–¥–∞–µ–º:\n"
        "‚Ä¢ –§–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞ –¥–ª—è Telegram\n"
        "‚Ä¢ –†–∞–±–æ—á–∏–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞\n"
        "‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7\n\n"
        "‚è±Ô∏è –°—Ä–æ–∫–∏:\n"
        "‚Ä¢ –î–æ—Å—Ç–∞–≤–∫–∞: 5-15 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã\n"
        f"‚Ä¢ —Ä–µ–≥: –≥–æ–¥ –Ω–∞–∑–∞–¥\n\n"
        "üõ°Ô∏è –ì–∞—Ä–∞–Ω—Ç–∏–∏:\n"
        "‚Ä¢ –ó–∞–º–µ–Ω–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö\n"
        "‚Ä¢ –í–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏\n\n"
        "üí≥ –û–ø–ª–∞—Ç–∞:\n"
        f"‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥–æ–º –Ω–∞ –∫–∞—Ä—Ç—É {CARD_NUMBER}\n"
        f"‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–æ–º: {AUTHOR_USERNAME}\n"
        "‚Ä¢ –í—ã–¥–∞—á–∞ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n\n"
        "üìä –û—Ç–∑—ã–≤—ã:\n"
        f"‚Ä¢ –¢–ì-–∫–∞–Ω–∞–ª: {CHANNEL_LINK}\n\n"
        "üë®‚Äçüíª –ê–≤—Ç–æ—Ä—ã:\n"
        f"‚Ä¢ {AUTHOR_USERNAME}"
    )
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(
        text="üì¢ –ö–∞–Ω–∞–ª —Å –æ—Ç–∑—ã–≤–∞–º–∏", 
        url=CHANNEL_LINK
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥", 
        callback_data="back_to_main"
    ))
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        info_text,
        reply_markup=keyboard.as_markup()
    )

# –ê–ª—å—è–Ω—Å
@dp.callback_query(lambda c: c.data == "alliance")
async def show_alliance(callback: types.CallbackQuery):
    alliance_text = (
        "ü§ù –ê–ª—å—è–Ω—Å\n\n"
        "–ë–æ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –ø–æ–º–æ—â—å—é:"
    )
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(
        text="@UGLYLELOOSH", 
        url=f"https://t.me/{CREATOR_LINK[1:]}"
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥", 
        callback_data="back_to_main"
    ))
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        alliance_text,
        reply_markup=keyboard.as_markup()
    )

# –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
@dp.callback_query(lambda c: c.data == "admin_panel")
async def admin_panel(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    keyboard = InlineKeyboardBuilder()
    
    keyboard.add(InlineKeyboardButton(
        text="‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä", 
        callback_data="admin_add_number_menu"
    ))
    keyboard.add(InlineKeyboardButton(
        text="üìù –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä–æ–≤", 
        callback_data="admin_add_multiple"
    ))
    keyboard.add(InlineKeyboardButton(
        text="üí∞ –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É", 
        callback_data="admin_edit_price_menu"
    ))
    keyboard.add(InlineKeyboardButton(
        text="üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", 
        callback_data="admin_stats"
    ))
    keyboard.add(InlineKeyboardButton(
        text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –í–°–ï –Ω–æ–º–µ—Ä–∞", 
        callback_data="admin_clear_all"
    ))
    
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥", 
        callback_data="back_to_main"
    ))
    
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        "‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        reply_markup=keyboard.as_markup()
    )

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –Ω–æ–º–µ—Ä–∞
@dp.callback_query(lambda c: c.data == "admin_clear_all")
async def admin_clear_all(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(
        text="‚úÖ –î–∞, —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–æ–º–µ—Ä–∞",
        callback_data="confirm_clear_all"
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚ùå –û—Ç–º–µ–Ω–∞",
        callback_data="admin_panel"
    ))
    keyboard.adjust(2)
    
    await callback.message.edit_text(
        "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n"
        "–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –Ω–æ–º–µ—Ä–∞ –∏–∑ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω.\n"
        "–ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ (–Ω–µ–ø—Ä–æ–¥–∞–Ω–Ω—ã–µ) –Ω–æ–º–µ—Ä–∞.\n"
        "–ü—Ä–æ–¥–∞–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ.\n\n"
        "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?",
        reply_markup=keyboard.as_markup()
    )

@dp.callback_query(lambda c: c.data == "confirm_clear_all")
async def confirm_clear_all(callback: types.CallbackQuery):
    data = load_numbers()
    
    cleared_count = 0
    for country in data:
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
        sold_numbers = [num for num in data[country]["numbers"] if num.get("used", False)]
        cleared_count += len(data[country]["numbers"]) - len(sold_numbers)
        data[country]["numbers"] = sold_numbers
    
    save_numbers(data)
    
    await callback.message.edit_text(
        f"‚úÖ –£–¥–∞–ª–µ–Ω–æ {cleared_count} –Ω–æ–º–µ—Ä–æ–≤!\n\n"
        "–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —É–¥–∞–ª–µ–Ω—ã.\n"
        "–ü—Ä–æ–¥–∞–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏."
    )

# –ú–µ–Ω—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞
@dp.callback_query(lambda c: c.data == "admin_add_number_menu")
async def admin_add_number_menu(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    data = load_numbers()
    countries = list(data.keys())
    
    keyboard = InlineKeyboardBuilder()
    
    for country in countries:
        keyboard.add(InlineKeyboardButton(
            text=country,
            callback_data=f"admin_add_to_{country}"
        ))
    
    keyboard.add(InlineKeyboardButton(
        text="‚ûï –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∞",
        callback_data="admin_new_country"
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥",
        callback_data="admin_panel"
    ))
    
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        "üåç –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞:",
        reply_markup=keyboard.as_markup()
    )

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω—É
@dp.callback_query(lambda c: c.data.startswith("admin_add_to_"))
async def admin_add_to_country(callback: types.CallbackQuery, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    country = callback.data.split("_")[3]
    
    await state.set_state(AdminStates.adding_number)
    await state.update_data(country=country)
    
    await callback.message.edit_text(
        f"üìù –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–ª—è —Å—Ç—Ä–∞–Ω—ã {country} –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n"
        f"+1234567890\n\n"
        f"–¶–µ–Ω–∞ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ({load_numbers()[country]['price']}‚ÇΩ)"
    )

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–º–µ—Ä–æ–≤
@dp.callback_query(lambda c: c.data == "admin_add_multiple")
async def admin_add_multiple_start(callback: types.CallbackQuery, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    data = load_numbers()
    countries = list(data.keys())
    
    keyboard = InlineKeyboardBuilder()
    
    for country in countries:
        keyboard.add(InlineKeyboardButton(
            text=country,
            callback_data=f"admin_multi_to_{country}"
        ))
    
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥",
        callback_data="admin_panel"
    ))
    
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        "üåç –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤:",
        reply_markup=keyboard.as_markup()
    )

@dp.callback_query(lambda c: c.data.startswith("admin_multi_to_"))
async def admin_multi_to_country(callback: types.CallbackQuery, state: FSMContext):
    country = callback.data.split("_")[3]
    
    await state.set_state(AdminStates.adding_multiple_numbers)
    await state.update_data(country=country)
    
    await callback.message.edit_text(
        f"üìù –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω—ã {country} –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É:\n"
        f"–§–æ—Ä–º–∞—Ç: +1234567890\n\n"
        f"–ü—Ä–∏–º–µ—Ä:\n"
        f"+8801112233\n"
        f"+8802223344\n"
        f"+8803334455"
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–º–µ—Ä–æ–≤
@dp.message(AdminStates.adding_multiple_numbers)
async def process_multiple_numbers(message: types.Message, state: FSMContext):
    user_data = await state.get_data()
    country = user_data.get('country')
    
    if not country:
        await message.answer("‚ùå –û—à–∏–±–∫–∞: —Å—Ç—Ä–∞–Ω–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞")
        await state.clear()
        return
    
    phone_numbers = message.text.strip().split('\n')
    valid_numbers = []
    invalid_numbers = []
    
    for phone_number in phone_numbers:
        phone_number = phone_number.strip()
        if phone_number.startswith('+') and phone_number[1:].replace(' ', '').isdigit() and len(phone_number) > 5:
            valid_numbers.append(phone_number)
        else:
            invalid_numbers.append(phone_number)
    
    if not valid_numbers:
        await message.answer("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞")
        return
    
    data = load_numbers()
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID
    if data[country]["numbers"]:
        current_id = max(num['id'] for num in data[country]["numbers"])
    else:
        current_id = 0
    
    added_count = 0
    for phone_number in valid_numbers:
        current_id += 1
        data[country]["numbers"].append({
            "id": current_id,
            "number": phone_number,
            "price": data[country]["price"],
            "used": False
        })
        added_count += 1
    
    save_numbers(data)
    
    response = f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {added_count} –Ω–æ–º–µ—Ä–æ–≤ –≤ —Å—Ç—Ä–∞–Ω—É {country}\n\n"
    
    if invalid_numbers:
        response += f"‚ùå –ù–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ (–Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç): {len(invalid_numbers)} –Ω–æ–º–µ—Ä–æ–≤\n"
        for invalid in invalid_numbers[:5]:
            response += f"   {invalid}\n"
        if len(invalid_numbers) > 5:
            response += f"   ... –∏ –µ—â–µ {len(invalid_numbers) - 5}\n"
    
    await message.answer(response)
    await state.clear()

# –ú–µ–Ω—é –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã
@dp.callback_query(lambda c: c.data == "admin_edit_price_menu")
async def admin_edit_price_menu(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    data = load_numbers()
    countries = list(data.keys())
    
    keyboard = InlineKeyboardBuilder()
    
    for country in countries:
        keyboard.add(InlineKeyboardButton(
            text=f"{country} - {data[country]['price']}‚ÇΩ",
            callback_data=f"admin_edit_price_{country}"
        ))
    
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥",
        callback_data="admin_panel"
    ))
    
    keyboard.adjust(1)
    
    await callback.message.edit_text(
        "üí∞ –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã:",
        reply_markup=keyboard.as_markup()
    )

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
@dp.callback_query(lambda c: c.data.startswith("admin_edit_price_"))
async def admin_edit_price(callback: types.CallbackQuery, state: FSMContext):
    country = callback.data.split("_")[3]
    
    await state.set_state(AdminStates.editing_price)
    await state.update_data(country=country)
    
    current_price = load_numbers()[country]["price"]
    
    await callback.message.edit_text(
        f"üí∞ –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –¥–ª—è {country}: {current_price}‚ÇΩ\n\n"
        f"–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é —Ü–µ–Ω—É (—Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ):"
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–π —Ü–µ–Ω—ã
@dp.message(AdminStates.editing_price)
async def process_edit_price(message: types.Message, state: FSMContext):
    user_data = await state.get_data()
    country = user_data.get('country')
    
    try:
        new_price = int(message.text.strip())
        
        if new_price <= 0:
            await message.answer("‚ùå –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0")
            return
        
        data = load_numbers()
        
        if country not in data:
            await message.answer("‚ùå –°—Ç—Ä–∞–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            return
        
        data[country]["price"] = new_price
        
        for num in data[country]["numbers"]:
            if not num.get("used", False):
                num["price"] = new_price
        
        save_numbers(data)
        
        await message.answer(f"‚úÖ –¶–µ–Ω–∞ –¥–ª—è {country} –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ {new_price}‚ÇΩ")
        
    except ValueError:
        await message.answer("‚ùå –í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ")
        return
    
    await state.clear()

# –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∞
@dp.callback_query(lambda c: c.data == "admin_new_country")
async def admin_new_country(callback: types.CallbackQuery, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    await state.set_state(AdminStates.adding_country)
    
    await callback.message.edit_text(
        "üåç –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω—ã –∏ —Ü–µ–Ω—É —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:\n"
        "–ü—Ä–∏–º–µ—Ä: –ë—Ä–∞–∑–∏–ª–∏—è,150\n\n"
        "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–º–µ—Ä–∞ –≤ —ç—Ç—É —Å—Ç—Ä–∞–Ω—É."
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω—ã
@dp.message(AdminStates.adding_country)
async def process_new_country(message: types.Message, state: FSMContext):
    try:
        country, price = message.text.split(',')
        country = country.strip()
        price = int(price.strip())
        
        data = load_numbers()
        
        if country in data:
            await message.answer(f"‚ùå –°—Ç—Ä–∞–Ω–∞ {country} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
            return
        
        data[country] = {
            "price": price,
            "numbers": []
        }
        
        save_numbers(data)
        
        await message.answer(f"‚úÖ –°—Ç—Ä–∞–Ω–∞ {country} —Å–æ–∑–¥–∞–Ω–∞ —Å —Ü–µ–Ω–æ–π {price}‚ÇΩ\n\n"
                           f"–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–º–µ—Ä–∞ –≤ —ç—Ç—É —Å—Ç—Ä–∞–Ω—É —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.")
        await state.clear()
        
    except ValueError:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: –°—Ç—Ä–∞–Ω–∞,—Ü–µ–Ω–∞")

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞
@dp.message(AdminStates.adding_number)
async def process_add_number(message: types.Message, state: FSMContext):
    user_data = await state.get_data()
    country = user_data.get('country')
    
    if not country:
        await message.answer("‚ùå –û—à–∏–±–∫–∞: —Å—Ç—Ä–∞–Ω–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞")
        await state.clear()
        return
    
    phone_number = message.text.strip()
    
    if not (phone_number.startswith('+') and phone_number[1:].replace(' ', '').isdigit() and len(phone_number) > 5):
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ +1234567890")
        return
    
    data = load_numbers()
    
    for num in data[country]["numbers"]:
        if num["number"] == phone_number:
            await message.answer(f"‚ùå –ù–æ–º–µ—Ä {phone_number} —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ")
            return
    
    if data[country]["numbers"]:
        new_id = max(num['id'] for num in data[country]["numbers"]) + 1
    else:
        new_id = 1
    
    data[country]["numbers"].append({
        "id": new_id,
        "number": phone_number,
        "price": data[country]["price"],
        "used": False
    })
    
    save_numbers(data)
    
    await message.answer(
        f"‚úÖ –ù–æ–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω!\n"
        f"üåç –°—Ç—Ä–∞–Ω–∞: {country}\n"
        f"üìû –ù–æ–º–µ—Ä: {phone_number}\n"
        f"üí∞ –¶–µ–Ω–∞: {data[country]['price']}‚ÇΩ\n"
        f"üÜî ID: {new_id}"
    )
    
    await state.clear()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
@dp.callback_query(lambda c: c.data == "admin_stats")
async def admin_stats(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    data = load_numbers()
    
    stats_text = "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n\n"
    
    total_numbers = 0
    total_available = 0
    total_sold = 0
    total_value = 0
    
    for country, info in data.items():
        numbers = info["numbers"]
        available = sum(1 for num in numbers if not num.get("used", False))
        sold = len(numbers) - available
        
        stats_text += f"üåç {country}:\n"
        stats_text += f"   ‚Ä¢ –¶–µ–Ω–∞: {info['price']}‚ÇΩ\n"
        stats_text += f"   ‚Ä¢ –í—Å–µ–≥–æ: {len(numbers)} —à—Ç.\n"
        stats_text += f"   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ: {available} —à—Ç.\n"
        stats_text += f"   ‚Ä¢ –ü—Ä–æ–¥–∞–Ω–æ: {sold} —à—Ç.\n"
        stats_text += f"   ‚Ä¢ –í—ã—Ä—É—á–∫–∞: {sold * info['price']}‚ÇΩ\n\n"
        
        total_numbers += len(numbers)
        total_available += available
        total_sold += sold
        total_value += sold * info['price']
    
    stats_text += f"üìà –ò—Ç–æ–≥–æ:\n"
    stats_text += f"   ‚Ä¢ –í—Å–µ–≥–æ –Ω–æ–º–µ—Ä–æ–≤: {total_numbers} —à—Ç.\n"
    stats_text += f"   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ: {total_available} —à—Ç.\n"
    stats_text += f"   ‚Ä¢ –ü—Ä–æ–¥–∞–Ω–æ: {total_sold} —à—Ç.\n"
    stats_text += f"   ‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: {total_value}‚ÇΩ\n"
    stats_text += f"   ‚Ä¢ –°—Ç—Ä–∞–Ω—ã: {len(data)}"
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(
        text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å",
        callback_data="admin_stats"
    ))
    keyboard.add(InlineKeyboardButton(
        text="‚Ü©Ô∏è –ù–∞–∑–∞–¥",
        callback_data="admin_panel"
    ))
    keyboard.adjust(2)
    
    await callback.message.edit_text(
        stats_text,
        reply_markup=keyboard.as_markup()
    )

# –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
@dp.callback_query(lambda c: c.data == "back_to_main")
async def back_to_main(callback: types.CallbackQuery, state: FSMContext):
    await state.clear()
    await cmd_start(callback.message)

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
@dp.message(Command("reset"))
async def cmd_reset(message: types.Message):
    if message.from_user.id != ADMIN_ID:
        await message.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    keyboard = InlineKeyboardBuilder()
    keyboard.add(InlineKeyboardButton(text="‚úÖ –î–∞, —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ", callback_data="confirm_reset"))
    keyboard.add(InlineKeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∞", callback_data="admin_panel"))
    keyboard.adjust(2)
    
    await message.answer(
        "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n"
        "–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –Ω–æ–º–µ—Ä–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.\n"
        "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!\n\n"
        "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?",
        reply_markup=keyboard.as_markup()
    )

@dp.callback_query(lambda c: c.data == "confirm_reset")
async def confirm_reset(callback: types.CallbackQuery):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω")
        return
    
    # –°–æ–∑–¥–∞–µ–º —á–∏—Å—Ç—É—é –±–∞–∑—É
    clean_data = {
        "–ë–∞–Ω–≥–ª–∞–¥–µ—à": {"price": 120, "numbers": []},
        "–í—å–µ—Ç–Ω–∞–º": {"price": 115, "numbers": []},
        "–ò–Ω–¥–∏—è": {"price": 100, "numbers": []},
        "–ú—å—è–Ω–º–∞": {"price": 130, "numbers": []}
    }
    
    save_numbers(clean_data)
    
    await callback.message.edit_text(
        "‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω–∞!\n"
        "–í—Å–µ –Ω–æ–º–µ—Ä–∞ —É–¥–∞–ª–µ–Ω—ã.\n\n"
        "–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å."
    )

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async def main():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    init_data()
    
    print("=" * 50)
    print("ü§ñ –ë–û–¢ –ó–ê–ü–£–©–ï–ù!")
    print("=" * 50)
    print(f"üëë –ê–¥–º–∏–Ω ID: {ADMIN_ID}")
    print(f"üí≥ –ö–∞—Ä—Ç–∞: {CARD_NUMBER}")
    print(f"üë§ –î–µ—Ä–∂–∞—Ç–µ–ª—å: {CARD_HOLDER}")
    print(f"üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞: {SUPPORT_USERNAME}")
    print(f"üë§ –ê–≤—Ç–æ—Ä –¥–ª—è –≤—ã–¥–∞—á–∏: {AUTHOR_USERNAME}")
    print(f"üì¢ –ö–∞–Ω–∞–ª –æ—Ç–∑—ã–≤–æ–≤: {CHANNEL_LINK}")
    print(f"ü§ù –°–æ–∑–¥–∞—Ç–µ–ª—å: {CREATOR_LINK}")
    print("=" * 50)
    print("üíµ –û–ø–ª–∞—Ç–∞: –†–£–ë–õ–Ø–ú–ò –ø–æ –∫–∞—Ä—Ç–µ")
    print("‚úÖ –°–∏—Å—Ç–µ–º–∞: –°—Ç–∞—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è")
    print("üì± –°—Ç–∞—Ç—É—Å: –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    try:
        await dp.start_polling(bot)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞: {e}")

if __name__ == "__main__":
    asyncio.run(main())
